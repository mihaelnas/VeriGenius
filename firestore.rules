/**
 * @file Firebase Security Rules for the University System.
 *
 * Core Philosophy:
 * This ruleset enforces that data is read-only for unauthenticated API access. The API endpoint will use a service account (via Firebase Admin SDK) to bypass these rules for legitimate writes, ensuring a secure-by-default posture for client-side access.
 *
 * Data Structure:
 * - /students/{studentId}: Stores individual student profiles.
 * - /classes/{classId}: Stores information about each class.
 *
 * Key Security Decisions:
 * - All data is read-only for clients. This prevents any unauthorized modification from the client-side SDK.
 * - Write operations (create, update, delete) are disallowed for all client-side users. All modifications must go through the secure API endpoint which uses admin privileges.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Secures student profile data.
     * @path /students/{studentId}
     * @allow (get, list) - Publicly readable for validation purposes.
     * @deny (write) - All writes must be performed by the backend service.
     */
    match /students/{studentId} {
      allow read: if true;
      allow write: if false; 
    }

    /**
     * @description Secures class data.
     * @path /classes/{classId}
     * @allow (get, list) - Allows anyone to read class data for discovery.
     * @deny (write) - All writes must be performed by the backend service.
     */
    match /classes/{classId} {
      allow read: if true;
      allow write: if false;
    }
  }
}
